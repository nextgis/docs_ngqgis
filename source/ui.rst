.. sectionauthor:: Дмитрий Барышников <dmitry.baryshnikov@nextgis.ru>

.. _ngqgis_ui:

********************************
Описание интерфейса NextGIS QGIS
********************************




.. index::
   single:main window

При первом запуске :program:`NextGIS QGIS` пользователь видит окно, показанное ниже 
(номерами от 1 до 5 выделены пять основных областей, которые рассматриваются далее):


.. todo:
   Заменить скриншот на :program:`NextGIS QGIS`


.. _fig_startup:


.. figure:: /_static/UIMainWindow.png
   :align: center
   :width: 35em

   Интерфейс :program:`NextGIS QGIS` с загруженным проектом.
   





.. note::
   Внешний вид элементов интерфейса (заголовки окон и т.п.) может отличаться, в зависисмости от операционной системы и менеджера окон.

Интерфейс :program:`NextGIS QGIS` разделяется на пять областей:

#. Главное меню
#. Панель инструментов
#. Дерево слоёв
#. Область карты
#. Строка состояния
#. Кнопка проекции

Компоненты интерфейса :program:`NextGIS QGIS`, комбинации клавиш и контекстная 
справка более подробно описаны в следующих разделах

.. _label_menubar:

Главное меню
------------------------------------

.. index::
   single:menus


.. figure:: /_static/UIMainWindowMenu.png
   :align: center
   :width: 35em


Главное меню предоставляет доступ ко всем возможностям :program:`NextGIS QGIS` в 
виде стандартного иерархического меню. Ниже показаны меню верхнего уровня и краткое 
описание их содержимого, а также значки соответствующих им инструментов по мере 
их появления на панели инструментов и комбинации клавиш клавиатуры. Комбинации клавиш, 
описанные в этом разделе, заданы по умолчанию, но их можно изменить, вызвав диалог 
настройки из меню 
:menuselection:`Установки --> Комбинации клавиш...`.

Несмотря на то, что большинству пунктов меню соответствует свой инструмент - меню 
и панели инструментов организованы по-разному. Панель инструментов, в которой находится 
инструмент, показана после каждого пункта меню в виде флажка. Дополнительную информацию 
об инструментах и панелях инструментов можно найти в разделе :ref:`label_toolbars`.

.. note:
   Дополнительные модули появляются в различных меню, поэтому на разных компьютерах набор этих меню отличается.


.. todo:
   Тут была большая таблица, просто со списком всех пунктов меню, я её пропустил из-за отсутствия смысла и трудоёмкости перевода.



.. _`label_toolbars`:

Панель инструментов
-------------------------------

.. index::
   single:toolbar


.. figure:: /_static/UIMainWindowButtons.png
   :align: center
   :width: 35em


Из панели инструментов можно запустить множество тех же самых функций, что и из меню, 
и ещё дополнительне инструменты для взаимодействия с картой. У каждой кнопки есть 
всплывающая подсказка - наведите мышку на кнопку, и на экране появится короткое описание.

Каждую панель инструментом можно передвигать по окну для ваших нужд. Панели можно 
включать-выключать при помощи контекстного меню, которое вызывается при нажатия 
правой клавиши манипулятора мышь.

.. tip::

   В документации будут встречаться команды "Найдите кнопку на такой-то панели инструментов". Для того что бы найти конкретную панель инструментов: нажмите правой кнопкой мыши на пустом участке панели инструментов. В контекстном меню выключите и включите заданную панель, тогда вы увидите её на экране.


.. index::
   single:layout toolbars

.. todo:
   уточнить названия меню




.. _`label_legend`:

Дерево слоёв
----------------------------------

Понятие **Слой** будет часто встречаться в инструкции. Слой - это то, что видно 
в дереве слоёв, технически это один файл или одна таблица в БД. Их можно включать 
и выключать. Можно изменять порядок и объединять в группы.

.. figure:: /_static/UIMainWindowLayers.png
   :align: center
   :width: 35em


.. index::
   single:legend

.. todo:
   спросить, допустимо ли словосочетание "включает-выключает"

В дереве слоёв перечислены все слои открытого проекта. У каждого элемента есть флажок, 
который включает-выключает слой. Сверху дерева слоёв находится своя панель инструментов с командами: :guilabel:`Добавить группу слоёв`, :guilabel:`Управление видимости слоя`, :guilabel:`Фильтровать легенду по содержимому карты`, :guilabel:`Развернуть все`, :guilabel:`Свернуть все`, :guilabel:`Удалить слой или группу`.



   .. figure:: /_static/user_manual/introduction/layer_toobar.png
      :align: center

      Панель инструментов в дереве слоёв 

Кнопка |mActionShowPresets| позволяет добавить предустановку (preset) какие слои выключены, какие - включены. Это значит, что вы можете выбрать, какие слои на карте будут включены, и сохранить несколько таких настроек.  

Все эти предустановки так же видны из компоновщика карты. Вы можете составлять карты для печати на основе заданных вами комбинаций слоёв (см. :ref:`composer`).



.. index::
   single:layer visibility

Слой можно выделить мышью и перетащить вверх или вниз для изменения порядка слоёв. 
Слой, находящийся сверху в списке, будет рисоваться на карте поверх других.

.. note::

   Это поведение может быть переопределено в панели ‘Порядок слоёв’.

Cлои в панели слоёв могут быть объединены в группы. Для этого есть два способа:

#. Нажать кнопку добавления новой группы |mActionFolder|. Ввести имя новой группы и нажать :kbd:`Enter`. Нажать на существующий слой и перетащить его в группу.
#. Выделить несколько слоёв, нажать правой кнопкой в окне слоёв, и выбрать :guilabel:`Сгруппировать выделенное`. Выбранные слои автоматически поместятся в новую группу. 

Что бы вынести слои из группы, перетащите их по дереву слоёв выше или ниже этой группы, или нажмите правой кнопкой на них и выберите :guilabel:`Сделать элементом первого уровня`.

Группы могут быть вложены в другие группы.

Флажок возле имени группы даёт возможность переключать видимость всех слоев в группе одним действием.

Содержимое контекстного меню слоя, вызываемого правой кнопкой мыши, зависит от того, растровый это слой, или векторный.

.. todo:
   Тут был список кнопок меню **Right mouse button menu for raster layers**, я его выкинул, потому что от него толка нет.

Вы можете выделять по несколько слоёв сразу, зажав :kbd:`Ctrl` и нажимая на них левой клавишей мыши. Можно выделить несколько слоёв и сразу объединить их в новую группу. Можно выделить несколько слоёв и сразу удалить из из проекта, нажав :kbd:`Ctrl+D`. Удаляются слои из проекта, а их файлы с жёсткого диска - не удаляются.

.. todo:
   раздел "Working with the Legend independent layer" order я сократил, потому что никогда его не использовал и он длинный


Область карты
------------------

.. index::`map view`

Это основное окно :program:`NextGIS QGIS` --- тут рисуется карта. Вид изображаемой карты зависит от того, какие слои включены в панели слоёв, и какие им заданы стили. 

.. figure:: /_static/UIMainWindowMap.png
   :align: center
   :width: 35em


.. tip::
   **Масштабирование карты с помощью колеса мыши**

   Для изменения масштаба карты используйте колесо мыши. Поместите курсор на область карты, и вращайте колесо. При этом карта отцентрируется на позиции курсора. Вы можете настроить поведение колеса мыши в меню :menuselection:`Установки --> Параметры --> Инструменты --> Прокрутка и масштабирование`.

.. tip::
   **Перемещение карты, используя клавиши со стрелками и клавишу пробела**

   .. index::
      single:pan arrow keys

   Вы можете поместить курсор мыши на карту, и двигать карту клавишами со стрелками на клавиатуре.   Так же можно нажать клавишу пробел или колесо мыши, и двигать карту мышью.

.. _`label_mapoverview`:


.. _`label_statusbar`:

Строка состояния
-------------------

.. figure:: /_static/UIMainWindowStatusbar.png
   :align: center
   :width: 35em


В строке состояния показывается позиция курсора на карте в текущих координатах 
(то есть метрах или градусах). Слева от окна координат есть кнопка, которая переключает показ между текущими координатами и охватом (bbox, extent).

Рядом находится список масштабов. В нём можно выбрать предустановленные масштабы 
от 1:500 to 1:1000000, или ввести точное значение с клавиатуры.

Правее списка масштабов находится окно, в котором вы можете задать поворот карты 
в градусах по часовой стрелке.

Флажок :guilabel:`Отрисовка` при отключении остановит отрисовку карты. Если на экране 
открыто много тяжёлых слоёв, и отрисовка начинает тормозить, то можно временно выключить 
отрисовку, отключить лишние слои. 

Справа находится кнопка выбора проекции. На ней написан код EPSG текущей системы координат. 
Если её нажать, то откроется окно свойств проекции.
